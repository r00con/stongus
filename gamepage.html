<!DOCTYPE html>
<html>
<head>
<title>Stongus</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
body{
  margin:0;
  font-family:'Press Start 2P';
  background:
    linear-gradient(rgba(0,0,0,.75),rgba(0,0,0,.75)),
    url("background.png") center/cover no-repeat fixed;
  color:white;
}
.topbar{
  display:flex;
  justify-content:space-between;
  padding:12px;
  border-bottom:4px solid #333;
  background:rgba(0,0,0,.85);
}
button{font-family:'Press Start 2P';}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
  gap:15px;
  padding:20px;
}
.card{
  border:4px solid #333;
  padding:15px;
  background:rgba(0,0,0,.75);
  cursor:pointer;
}
</style>
</head>
<body>

<div class="topbar">
  <div id="user"></div>
  <div>
    $<span id="money">0</span>
    <button onclick="friends()">Friends</button>
  </div>
</div>

<div class="grid" id="stocks"></div>

<script>
const user=localStorage.getItem("stongus_user")||"LockedIn";
document.getElementById("user").innerText=user;

let prices={},player={};

async function load(){
  prices=await (await fetch("/stocks")).json();
  player=await (await fetch(`/player?user=${user}`)).json();
  document.getElementById("money").innerText=player.money;
  render();
}

function render(){
  const box=document.getElementById("stocks");
  box.innerHTML="";
  Object.keys(prices).forEach(s=>{
    const div=document.createElement("div");
    div.className="card";
    div.innerHTML=`${s}<br>Price: $${prices[s]}`;
    div.onclick=()=>{
      localStorage.setItem("stongus_selected_stock",s);
      location.href="stockspage.html";
    };
    box.appendChild(div);
  });
}

function friends(){location.href="friends.html";}
load();
</script>
</body>
</html>
